@model AdvanceCRM.Services.AMCReportData

@if ((bool?)ViewData["Printing"] == true)
{
	Layout = MVC.Views.Shared._LayoutNoNavigation;
}

<style>
    tr {
        page-break-inside: auto;
        page-break-after: auto
    }

    td {
        page-break-inside: auto;
        page-break-after: auto
    }
</style>

<script type="text/javascript">

var th = ['', 'Thousand', 'Million', 'Billion', 'Trillion'];

var dg = ['Zero', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine'];

var tn = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];

var tw = ['Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];

function toWords(s) {
	s = s.toString();
	s = s.replace(/[\, ]/g, '');
	if (s != parseFloat(s)) return 'not a number';
	var x = s.indexOf('.');
	if (x == -1) x = s.length;
	if (x > 15) return 'too big';
	var n = s.split('');
	var str = '';
	var sk = 0;
	for (var i = 0; i < x; i++) {
		if ((x - i) % 3 == 2) {
			if (n[i] == '1') {
				str += tn[Number(n[i + 1])] + ' ';
				i++;
				sk = 1;
			} else if (n[i] != 0) {
				str += tw[n[i] - 2] + ' ';
				sk = 1;
			}
		} else if (n[i] != 0) {
			str += dg[n[i]] + ' ';
			if ((x - i) % 3 == 0) str += 'Hundred ';
			sk = 1;
		}
		if ((x - i) % 3 == 1) {
			if (sk) str += th[(x - i - 1) / 3] + ' ';
			sk = 0;
		}
	}
	if (x != s.length) {
		var y = s.length;
		str += 'point ';
		for (var i = x + 1; i < y; i++) str += dg[n[i]] + ' ';
	}
	return (str.replace(/\s+/g, ' ')).concat('Only/-');
}
</script>

<body style="align-self:stretch; align-items:center; align-items:center">
    <table style="width:100%" border="0">
        @if (Model.Company.HeaderImage != null)
		{
        <tr style="border:none !important;">
            <td align="center" style="border:none !important; width:100%">&nbsp; <img src="~/upload/@Model.Company.HeaderImage" height="@Model.Company.HeaderHeight.Value.ToString()" width="@Model.Company.HeaderWidth.Value.ToString()" />&nbsp;</td>
        </tr>
		}
        <tr>
            <td align="center" style="border:outset; width:100%"><h4> Annual Maintenance Contract </h4></td>
        </tr>
    </table>
    <table style="width:100%" border="1">
        <tr>
            <td>
                <table style="width:100%; border-collapse:collapse" border="1" cellpadding="25" cellspacing="10">
                    <tr>
                        <td align="center" style="width:20%">
                            &nbsp;
                            @if (Model.Company.Logo != null)
							{
                            <img src="~/upload/@Model.Company.Logo" height="@Model.Company.LogoHeight.Value.ToString()" width="@Model.Company.LogoWidth.Value.ToString()" />
							}
                            &nbsp;
                        </td>

                        <td align="center" style="width:40%">
                            <h5><strong>@Model.Company.Name</strong></h5>
                            @if (Model.Company.Slogan != null)
							{
                            @Model.Company.Slogan
                            <br />
							}
                            @Model.Company.Address
                            <br />
                            @Model.Company.Phone
                        </td>
                        <td align="left" style="width:40%">
                            <strong>&nbsp; AMC No </strong>: @DateTime.Now.Year/@Model.AMC.AMCNo , <strong> Date </strong>: @Model.AMC.Date.Value.ToShortDateString()<br />
                            <strong>&nbsp; Name </strong>
                            : @Model.AMC.ContactsName<br />
                            <strong>&nbsp; Phone </strong>: @Model.AMC.ContactsPhone<br />
                            <strong>&nbsp; Address </strong>: @Model.AMC.ContactsAddress
                        </td>
                    </tr>
                </table>
            </td>
        </tr>

        @* Products *@
        <tr>
            <td colspan="8" align="center" class="bg-gray-light">
                &nbsp;
            </td>
        </tr>
        <tr>
            <td>
                <table cellpadding="100" cellspacing="100" border="1" style="width:100%">
                    <tr>
                        <td align="center"><strong>&nbsp;Sr. No.&nbsp;</strong></td>
                        <td align="center"><strong>&nbsp;Code&nbsp;</strong></td>
                        <td align="center"><strong>&nbsp;Product&nbsp;</strong></td>
                        <td align="center"><strong>&nbsp;Rate&nbsp;</strong></td>
                        <td align="center"><strong>&nbsp;Qty/Visits&nbsp;<br />(Or Both)</strong></td>
                        <td align="center"><strong>&nbsp;Discount&nbsp;</strong></td>
                        <td align="center"><strong>&nbsp;Tax1&nbsp;</strong></td>
                        <td align="center"><strong>&nbsp;Tax2&nbsp;</strong></td>
                        @if (Model.taxable == true)
						{
                        <td align="center"><strong>Tax</strong></td>
						}
                        <td align="center"><strong>Total</strong></td>
                        <td align="center"><strong>Grand Total</strong></td>
                    </tr>
                    @{ int srno = 1; decimal Total = 0; decimal gTotal = 0; decimal Tax1Total = 0; decimal Tax2Total = 0;}
                    @foreach (var qp in Model.AMCProducts)
					{
                    <tr>
                        <td align="center">@srno</td>
                        <td align="Left">&nbsp;@qp.ProductsCode</td>
                        <td align="left">&nbsp;@qp.ProductsName<br /><span style="white-space: pre-line; font-size:smaller"><i>@qp.ProductsDescription</i></span></td>
                        <td align="right">&nbsp;@qp.Rate.Value&nbsp;</td>
                        <td align="center">@qp.Quantity.Value&nbsp;</td>
                        <td align="right">
                            @qp.Discount.Value%&nbsp;@if (qp.DiscountAmount.Value > 0)
							{<text>&amp; Amt:</text>@qp.DiscountAmount.Value}
                        </td>
                        <td align="center">@qp.TaxType1 (@qp.Percentage1%) <br />&nbsp;Amount: @qp.Tax1Amount.Value&nbsp;</td>
                        <td align="center">@qp.TaxType2 (@qp.Percentage2%) <br />&nbsp;Amount: @qp.Tax2Amount.Value&nbsp;</td>
                        @*@if (Model.taxable == true)
                            {
                                <td align="left">
                                    @if (qp.TaxType1 != null)
                                    {
                                        <text> &nbsp; @qp.TaxType1 : @qp.Percentage1 </text>
                                    }
                                    @if (qp.TaxType1 != null && qp.TaxType2 != null)
                                    {
                                        <text>,</text>
                                    }
                                    @if (qp.TaxType2 != null)
                                    {
                                        <text> &nbsp; @qp.TaxType2: @qp.Percentage2 </text>
                                    }
                                </td>
                            }*@
                        <td align="right">@qp.LineTotal.Value&nbsp;</td>
                        <td align="right">@qp.GrandTotal.Value&nbsp;</td>

                        @{ Total = Total + qp.LineTotal.Value;
								gTotal = gTotal + qp.GrandTotal.Value;
								Tax1Total = Tax1Total + qp.Tax1Amount.Value;
								Tax2Total = Tax2Total + qp.Tax2Amount.Value;
								srno++;
                        }
                    </tr>
					}

                    @{int diff = Model.AMC.Lines.Value - srno; }

                    @for (int i = diff; i > 0; i--)
					{
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        @*@if (Model.taxable == true)
                            {
                                <td>&nbsp;</td>
                            }*@
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                    </tr>
					}

                    <tr>
                        @if (Model.taxable == true)
						{
                        <td colspan="11" align="center" class="bg-gray" style="text-decoration-color:antiquewhite">
                            &nbsp;
                        </td>
						}
						else
						{
                        <td colspan="10" align="center" class="bg-gray" style="text-decoration-color:antiquewhite">
                            &nbsp;
                        </td>
						}
                    </tr>

                    @* Tax1Amount *@
                    <tr>
                        <td colspan="9" align="right"><strong> Tax1 Total:&nbsp;</strong></td>
                        <td align="right"><strong>@Tax1Total.ToString()&nbsp;</strong></td>
                    </tr>

                    @* Tax2Amount *@
                    <tr>
                        <td colspan="9" align="right"><strong> Tax2 Total:&nbsp;</strong></td>
                        <td align="right"><strong>@Tax2Total.ToString()&nbsp;</strong></td>
                    </tr>

                    @* Total *@
                    <tr>
                        <td colspan="9" align="right"><strong> Total:&nbsp;</strong></td>
                        <td align="right"><strong>@Total.ToString("#,##0.00")&nbsp;</strong></td>
                    </tr>
                    @* Grand Total *@
                <tr>
                    <td colspan="8" align="right">
                        @*@if (Model.AMC.DueDate != null)
        {
            <text><strong>Valid Date:</strong> @Model.AMC.DueDate.Value.ToShortDateString() &nbsp;</text>
        }*@

                        @*<text><strong>Start Date:</strong> @Model.AMC.StartDate.Value.ToShortDateString() &nbsp;</text>
                        <text><strong>End Date:</strong> @Model.AMC.EndDate.Value.ToShortDateString() &nbsp;</text>*@

                        <text><strong>Start Date:</strong> @Model.AMC.StartDate.Value.ToShortDateString() – <strong>End Date:</strong> @Model.AMC.EndDate.Value.ToShortDateString() &nbsp;</text>


                    </td>
                    <td align="right"><strong>Grand Total:&nbsp;</strong></td>
                    <td align="right"><strong>@gTotal.ToString("#,##0.00")&nbsp;</strong></td>

                    @*<td colspan="9" align="right"><strong> Grand Total:&nbsp;</strong></td>
                    <td align="right"><strong>@gTotal.ToString()&nbsp;</strong></td>*@
                </tr>
                    <tr>
                        <td colspan="10" bgcolor="wheat">
                            <strong>Total in Words:</strong>
                            <script>document.write(toWords(@gTotal))</script>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    @* Terms *@
    <br />
    @if (Model.AMCTerms.Count > 0)
	{
    <h5>Terms &amp; Condition's</h5>
    <table cellpadding="100" cellspacing="100" border="1" style="width:100%">
        @{ int Tsrno = 1;}
        @foreach (var qt in Model.AMCTerms)
			{
        <tr>
            <td align="Left">@Tsrno.&nbsp;@qt.Terms</td>
            @{Tsrno++; }
        </tr>
			}
    </table>
	}

    @if (Model.Company.FooterImage != null)
	{
    <table>
        <tr style="border:none !important;">
            <td align="center" style="border:none !important; width:100%">&nbsp; <img src="~/upload/@Model.Company.FooterImage" height="@Model.Company.FooterHeight.Value.ToString()" width="@Model.Company.FooterWidth.Value.ToString()" />&nbsp;</td>
        </tr>
    </table>
	}

</body>
