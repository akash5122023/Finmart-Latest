@using System.Net;
@using System.Net.Mail;

@using Serenity;

@{ string emailtovar = "";}

@model AdvanceCRM.Common.SalesOperationsDashboardPageModel
@inject Serenity.ITextLocalizer Localizer
@{
    ViewData["Title"] = "Sales & Operations Dashboard";
    ViewData["PageId"] = "SalesOperationsDashboard";
}

@section Head {
    <link rel="stylesheet" href="~/Content/iCheck/flat/blue.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/Scripts/morris/morris.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/Scripts/datepicker/datepicker3.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/Scripts/daterangepicker/daterangepicker-bs3.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/Scripts/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css" asp-append-version="true" />
    <script src="~/Scripts/raphael/raphael-min.js" asp-append-version="true"></script>
    <script src="~/Scripts/morris/morris.min.js" asp-append-version="true"></script>
    <script src="~/Scripts/sparkline/jquery.sparkline.min.js" asp-append-version="true"></script>
    <script src="~/Scripts/knob/jquery.knob.js" asp-append-version="true"></script>
    <script src="~/Scripts/daterangepicker/moment.min.js" asp-append-version="true"></script>
    <script src="~/Scripts/daterangepicker/daterangepicker.js" asp-append-version="true"></script>
    <script src="~/Scripts/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.js"></script>
    <script src="~/Scripts/adminlte/demo.js"></script>

    <script src="~/amcharts/amcharts.js"></script>
    <script src="~/amcharts/gauge.js"></script>
    <script src="~/amcharts/plugins/export/export.min.js"></script>
    <script src="~/amcharts/plugins/responsive/responsive.min.js"></script>
    <link rel="stylesheet" href="~/amcharts/plugins/export/export.css" type="text/css" media="all" />
    <script src="~/amcharts/themes/light.js"></script>
}

@section ContentHeader {
    <h1>Sales & Operations @Localizer.Get("Navigation.Dashboard")<small>Combined Dashboard</small></h1>
}

@{
    var FCount = Model.CountOfAniversaryWishes + Model.CountOfBirthDayWishes + Model.CountOfIncorporationWishes;

    if (FCount > 0)
    {
        var str = "Todays wishes stats:<br/><br/>Birthday SMS: " + Convert.ToString(Model.CountOfBirthDayWishes) + ",<br/>Marriage Anniversary SMS: " + Convert.ToString(Model.CountOfAniversaryWishes) + ",<br/>Firm Anniversay SMS: " + Convert.ToString(Model.CountOfIncorporationWishes) + "";

        <script type="text/javascript">
            (function () {
                toastr.info("<br/><button type='button' id='ConfirmYes' class='btn clear'>Ok</button>",'@Html.Raw(str)', 'Daily wishes statistics', {
                    "closeButton": true,
                    "allowHtml": true,
                    "positionClass": "toast-top-center",
                    "timeOut": 0,
                    onShown: function (toast) {
                        $('#ConfirmYes').click(function () {
                            location.href = "#";
                        });
                    }
                });
            })();
        </script>
    }
}

<style>
    .small-box {
        background: linear-gradient(135deg, #007bff, #0056d2);
        color: white;
        border-radius: 15px;
        padding: 20px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        transition: 0.3s;
        min-height: 140px;
    }

    .small-box:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    }

    .small-box .inner h3 {
        font-size: 32px;
        font-weight: bold;
        margin: 0;
    }

    .small-box .inner p {
        font-size: 16px;
        opacity: 0.9;
        margin-top: 5px;
    }

    .small-box .icon {
        position: absolute;
        right: 10px;
        bottom: 10px;
        font-size: 60px;
        opacity: 0.2;
    }

    .small-box-footer {
        color: white !important;
        font-weight: 600;
        text-decoration: underline;
        position: absolute;
        bottom: 10px;
        left: 20px;
    }

    .small-box-footer:hover {
        color: #dfefff !important;
    }

    .small-box.bg-sales {
        background: linear-gradient(135deg, #007bff, #0056d2);
    }

    .small-box.bg-initial {
        background: linear-gradient(135deg, #28a745, #1e7e34);
    }

    .small-box.bg-login {
        background: linear-gradient(135deg, #17a2b8, #117a8b);
    }

    .small-box.bg-disbursement {
        background: linear-gradient(135deg, #ffc107, #d39e00);
    }

    .section-header {
        margin: 20px 0 15px 0;
        padding-bottom: 10px;
        border-bottom: 2px solid #e0e0e0;
    }

    .section-header h3 {
        margin: 0;
        color: #333;
        font-weight: 600;
    }
</style>

<!-- Inside Sales Section - Only visible if user has InsideSales:Read permission -->
@if (Model.CanViewInsideSales)
{
<div class="section-header">
    <h3><i class="fa fa-handshake-o"></i> Inside Sales</h3>
</div>
<div class="row">
    <div class="col-lg-3 col-md-4 col-xs-6">
        <div class="small-box bg-sales">
            <div class="inner">
                <h3>@Model.OpenMISSales</h3>
                <p>Inside Sales</p>
            </div>
            <div class="icon">
                <i class="fa fa-envelope"></i>
            </div>
            <a href="/FinmartInsideSales/InsideSales?Open" class="small-box-footer">
                More info <i class="fa fa-arrow-circle-right"></i>
            </a>
        </div>
    </div>
</div>
}

<!-- Operations Section - Only shows items user has permission to view -->
@if (Model.CanViewInitialProcess || Model.CanViewLoginProcess || Model.CanViewDisbursementProcess)
{
<div class="section-header">
    <h3><i class="fa fa-cogs"></i> Operations</h3>
</div>
<div class="row">
    @if (Model.CanViewInitialProcess)
    {
    <div class="col-lg-3 col-md-4 col-xs-6">
        <div class="small-box bg-initial">
            <div class="inner">
                <h3>@Model.OpenMISInitialProcess</h3>
                <p>Initial Process</p>
            </div>
            <div class="icon">
                <i class="fa fa-file-text"></i>
            </div>
            <a href="/Operations/MisInitialProcess?Open" class="small-box-footer">
                More info <i class="fa fa-arrow-circle-right"></i>
            </a>
        </div>
    </div>
    }

    @if (Model.CanViewLoginProcess)
    {
    <div class="col-lg-3 col-md-4 col-xs-6">
        <div class="small-box bg-login">
            <div class="inner">
                <h3>@Model.OpenMISLoginProcess</h3>
                <p>Login Process</p>
            </div>
            <div class="icon">
                <i class="fa fa-sign-in"></i>
            </div>
            <a href="/Operations/MisLogInProcess?Open" class="small-box-footer">
                More info <i class="fa fa-arrow-circle-right"></i>
            </a>
        </div>
    </div>
    }

    @if (Model.CanViewDisbursementProcess)
    {
    <div class="col-lg-3 col-md-4 col-xs-6">
        <div class="small-box bg-disbursement">
            <div class="inner">
                <h3>@Model.OpenMISDisbursementProcess</h3>
                <p>Disbursement Process</p>
            </div>
            <div class="icon">
                <i class="fa fa-money"></i>
            </div>
            <a href="/Operations/MisDisbursementProcess?Open" class="small-box-footer">
                More info <i class="fa fa-arrow-circle-right"></i>
            </a>
        </div>
    </div>
    }
</div>
}
