
@model AdvanceCRM.Common.DSRDashboardPageModel
@inject Serenity.ITextLocalizer Localizer
@{
    ViewData["Title"] = "DSR";
}
@section Head {

    <link rel="stylesheet" href="~/Content/iCheck/flat/blue.css">
    <link rel="stylesheet" href="~/Scripts/datepicker/datepicker3.css">
    <link rel="stylesheet" href="~/Scripts/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">
    <link href="~/Content/bootstrap-select.css" rel="stylesheet" />

    <script src="~/Scripts/daterangepicker/moment.min.js"></script>
    <script src="~/Scripts/datepicker/bootstrap-datepicker.js"></script>
    <script src="~/Scripts/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.js"></script>
    <script src="~/Scripts/bootstrap-select.js"></script>

}

<script>
    $(document).ready(function () {

        $("#ListId").on('change', function () {
            $("#ListId").val(this.value);

            if ($("#ListId").val() == "" || $("#date").val() == "" || $("#date1").val() == "")
                return;

            $.ajax(
                {
                    url: '@Url.Action("LoadData", "DSRDashboard")?UserId=' + $("#ListId").val() + '&date=' + $("#date").val() + '&date1=' + $("#date1").val(),
                    type: 'GET',
                    data: "",
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        $("#DetailsDiv").html(data);
                    },
                    error: function () {
                        toastr.error("error");
                    }
                });
        });

        $('#datepicker').on('changeDate', function (ev) {

            if ($("#ListId").val() == "" || $("#date").val() == "" || $("#date1").val() == "")
                return;
            $.ajax(
                {
                    url: '@Url.Action("LoadData", "DSRDashboard")?UserId=' + $("#ListId").val() + '&date=' + $("#date").val() + '&date1=' + $("#date1").val(),
                    type: 'GET',
                    data: "",
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        $("#DetailsDiv").html(data);
                    },
                    error: function () {
                        toastr.error("error");
                    }
                });
        });

           $('#datepicker1').on('changeDate', function (ev) {

               if ($("#ListId").val() == "" || $("#date").val() == "" || $("#date1").val() == "")
                return;
            $.ajax(
                {
                    url: '@Url.Action("LoadData", "DSRDashboard")?UserId=' + $("#ListId").val() + '&date=' + $("#date").val() + '&date1=' + $("#date1").val(),
                    type: 'GET',
                    data: "",
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        $("#DetailsDiv").html(data);
                    },
                    error: function () {
                        toastr.error("error");
                    }
                });
});

    });
</script>

@section ContentHeader {
    <h1>@ViewData["Title"] Dashboard<small>(Performance of 31 Days)</small></h1>
}
<div class="row">
    <!-- Left col -->
    <div class="col-md-12">
        <!-- TABLE: LATEST ORDERS -->
        <div class="box box-primary">
            <div class="box-body">
                <div class="form-group col-lg-5">
                    <label for="LabelforList" class="col-form-label">Select User<span class="kv-reqd">*</span></label>

                    <div class="input-group">
                        <div class="input-group-addon">
                            <i class="fa fa-user-circle"></i>
                        </div>
                        <select class="selectpicker form-control"
                                name="ListId"
                                id="ListId"
                                data-show-subtext="true"
                                data-live-search="true"
                                required title="Select Representative">
                            @foreach (var item in ViewBag.ListData)
                            {
                                <option value="@item.UserId">
                                    @item.DisplayName
                                </option>
                            }
                        </select>
                        <input type="hidden" name="SearchButton" value="true">
                    </div><!-- /.input group -->

                </div>
                <div class="form-group col-lg-3">
                    <div style='text-align:left;'>
                        <label class="col-form-label">Select Month</label>
                        <div class="input-group date" data-provide="datepicker" id="datepicker">
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                            <input type="text" class="form-control form-control-1 form-input input-sm fromq" placeholder="Select From Date" name="date" id="date">
                        </div><!-- /.input group -->
                    </div>

                    <script>
                        $('#datepicker').datepicker({
                            format: "dd-mm-yyyy",
                            viewMode: "dats",
                            minViewMode: "days"
                        });
                    </script>
                </div><!-- /.form group -->
                <div class="form-group col-lg-3 pull-right">
                    <div style='text-align:left;'>
                        <label class="col-form-label">Select Month</label>
                        <div class="input-group date" data-provide="datepicker" id="datepicker1">
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                            <input type="text" class="form-control form-control-1 form-input input-sm fromq" placeholder="Select To Date" name="date1" id="date1">
                        </div><!-- /.input group -->
                    </div>

                    <script>
                        $('#datepicker1').datepicker({
                            format: "dd-mm-yyyy",
                            viewMode: "days",
                            minViewMode: "days"
                        });
                    </script>
                </div><!-- /.form group -->

            </div><!-- /.box-body -->
        </div><!-- /.box -->
    </div><!-- /.col -->
</div><!-- /.row -->
<!-- Main row -->
<div class="row">
    <div class="col-md-12">
        <div class="box box-primary collapsed-box">
            <div class="box-header with-border">
                <i class="fa fa-code-fork"></i>
                <h3 class="box-title">Bifurcation for Enquiries (Last 31 days)</h3>
                <button class="btn btn-primary btn-sm pull-right" data-widget="collapse" data-toggle="tooltip" title="Collapse" style="margin-right: 5px;"><i class="fa fa-plus"></i></button>
            </div><!-- /.box-header -->

            <div class="box-body">
                <div class="col-md-6">
                    <div class="box box-solid">
                        <div class="box-header with-border bg-aqua-active">
                            <h3 class="box-title">Sourcewise</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-footer no-padding">
                            <div class="table-responsive">
                                <table class="table no-margin">
                                    <thead>
                                        <tr>
                                            <th>Sr. No.</th>
                                            <th>Source</th>
                                            <th>Count</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{ int cnt = 1;}

                                        @foreach (var item in Model.SourceWise.Select(x => x.Source).Distinct())
                                        {
                                            <tr>
                                                <td>@cnt</td>
                                                <td>@Html.DisplayFor(x => item)</td>
                                                <td>@Model.SourceWise.Where(y => y.Source == Html.DisplayFor(x => item).ToString()).Count()</td>
                                            </tr>
                                            cnt = cnt + 1;
                                        }
                                    </tbody>
                                </table>
                            </div><!-- /.table-responsive -->
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </div>
                <div class="col-md-6">
                    <div class="box box-solid">
                        <div class="box-header with-border bg-yellow">
                            <h3 class="box-title">Representativewise</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-footer no-padding">
                            <div class="table-responsive">
                                <table class="table no-margin">
                                    <thead>
                                        <tr>
                                            <th>Sr. No.</th>
                                            <th>Representative</th>
                                            <th>Count</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{ cnt = 1;}

                                        @foreach (var item in Model.RepWise.Select(x => x.AssignedUsername).Distinct())
                                        {
                                            <tr>
                                                <td>@cnt</td>
                                                <td>@Html.DisplayFor(x => item)</td>
                                                <td>@Model.RepWise.Where(y => y.AssignedUsername == Html.DisplayFor(x => item).ToString()).Count()</td>
                                            </tr>
                                            cnt = cnt + 1;
                                        }
                                    </tbody>
                                </table>
                            </div><!-- /.table-responsive -->
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </div>
            </div>
        </div>



    </div>
</div><!-- /.row -->

<div id="DetailsDiv">
</div>

