@model AdvanceCRM.Reports.QuotationReportModel

@*<strong>Quotation Statistics </strong>
    &nbsp;&nbsp; - &nbsp;&nbsp; <strong>From:</strong> @Model.Request.DateFrom.ToDateFormat() To: @Model.Request.DateTo.ToDateFormat()
    <table style="width:100%; border:groove" , border="1">
        <tr><td><strong> Statistics: </strong></td></tr>
        <tr>
            <td>&nbsp;&nbsp; Total Enquiries &nbsp;&nbsp;&nbsp;&nbsp; : &nbsp; @Model.All.Count</td>
        </tr>
        <tr>
            <td>
                &nbsp;&nbsp; Open Enquiries &nbsp;&nbsp;&nbsp;&nbsp;: &nbsp; @Model.Open.Count
            </td>
        </tr>
        <tr>
            <td>
                &nbsp;&nbsp; Closed Enquiries &nbsp; : &nbsp; @Model.Closed.Count
            </td>
        </tr>
    </table>

    <table style="width:100%; border:groove" , border="1">
        <tr><td><strong> Conversion: </strong></td></tr>
        <tr>
            <td>&nbsp;&nbsp; Won Enquiries&nbsp;&nbsp;&nbsp; : &nbsp; @Model.Won.Count</td>
        </tr>
        <tr>
            <td>
                &nbsp;&nbsp; Lost Enquiries &nbsp;&nbsp;&nbsp;&nbsp;: &nbsp; @Model.Lost.Count
            </td>
        </tr>
    </table>

    <table style="width:100%; border:groove" , border="1">
        <tr><td><strong> Ratio's: </strong></td></tr>
        <tr>
            @if (Model.Won.Count > 0)
            {
                double won = Model.Won.Count;
                double all = Model.All.Count;
                double ratio = ((won / all) * 100);
                <td>&nbsp;&nbsp; Conversion Ratio &nbsp;: &nbsp; @ratio.ToString()%</td>

            }
        </tr>
        <tr>
            @if (Model.Lost.Count > 0)
            {
                double lost = Model.Lost.Count;
                double all = Model.All.Count;
                double ratio = ((lost / all) * 100);
                <td>
                    &nbsp;&nbsp; Loss Ratio &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : &nbsp; @ratio.ToString()%
                </td>
            }
        </tr>
    </table>*@

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f8f9fa;
        margin: 20px;
    }

    .report-container {
        width: 100%;
        max-width: 800px;
        margin: auto;
        background: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
    }

    .report-title {
        font-size: 22px;
        font-weight: bold;
        text-align: center;
        color: #333;
        margin-bottom: 10px;
        text-transform: uppercase;
    }

    .report-subtitle {
        text-align: center;
        font-size: 14px;
        color: #555;
        margin-bottom: 20px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 15px;
        box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.1);
        background: white;
        border-radius: 8px;
        overflow: hidden;
    }

    th, td {
        padding: 14px;
        border: 1px solid #ddd;
        text-align: center;
    }

    th {
        background: #007bff;
        color: #ffffff;
        font-size: 14px;
        font-weight: bold;
        text-transform: uppercase;
    }

    td {
        font-size: 14px;
    }

    tr:nth-child(even) {
        background: #e3e3e3;
    }

    tr:hover {
        background: #f1f1f1;
        transition: 0.3s;
    }

    .highlight {
        background: #f8f9fa;
        font-weight: bold;
        text-align: left;
        padding-left: 15px;
    }


    .footer-note {
        text-align: center;
        font-size: 12px;
        margin-top: 15px;
        color: #777;
    }
</style>

<div style="font-size: 16px; font-weight: bold; margin-bottom: 10px;">
    Quotation Statistics
</div>

<div style="font-size: 14px; margin-bottom: 5px;">
    <strong>From:</strong> @Model.Request.DateFrom.ToDateFormat() &nbsp;
    <strong>To:</strong> @Model.Request.DateTo.ToDateFormat()
</div>

<table>
    <tr><th colspan="2">Statistics</th></tr>
    <tr><td class="highlight">Total Enquiries</td><td>@Model.All.Count</td></tr>
    <tr><td class="highlight">Open Enquiries</td><td>@Model.Open.Count</td></tr>
    <tr><td class="highlight">Closed Enquiries</td><td>@Model.Closed.Count</td></tr>
</table>

<table>
    <tr><th colspan="2">Conversion</th></tr>
    <tr><td class="highlight">Won Enquiries</td><td>@Model.Won.Count</td></tr>
    <tr><td class="highlight">Lost Enquiries</td><td>@Model.Lost.Count</td></tr>
</table>

<table>
    <tr><th colspan="2">Ratios</th></tr>

    @if (Model.Won.Count > 0)
    {
        double won = Model.Won.Count;
        double all = Model.All.Count;
        double ratio = ((won / all) * 100);
        <tr><td class="highlight">Conversion Ratio</td><td>@ratio.ToString("0.00")%</td></tr>

    }


    @if (Model.Lost.Count > 0)
    {
        double lost = Model.Lost.Count;
        double all = Model.All.Count;
        double ratio = ((lost / all) * 100);
        <tr><td class="highlight">Loss Ratio</td><td>@ratio.ToString("0.00")%</td></tr>
    }

</table>

<div class="footer-note">
    <em>Report generated automatically. Powered by BizPlus ERP.</em>
</div>